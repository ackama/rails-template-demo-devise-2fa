<h1>My multi-factor authentication setup</h1>

<h2>Summary</h2>
<p>
  <% if current_user.otp_enabled_and_required? %>
    Yay! Two-factor authentication is <strong>enabled</strong> on your account.
  <% else %>
    Two-factor authentication is currently <strong>disabled</strong> on your account. You can enable it using the links below.
  <% end %>
</p>
<p>
  <% if current_user.otp_backup_codes.present? %>
    Backup codes are <strong>stored</strong> on your account.
  <% else %>
    Backup codes are <strong>not stored</strong> on your account.
  <% end %>
</p>

<h2>Change your MFA setup</h2>

<hr />

<pre>
By clicking on this link, you accept that:

* Once you complete the set up on the next screen, you will be REQUIRED to use an OTP code to sign in
</pre>
<div><%= link_to "Enable MFA on my account", new_users_mfa_path %></div>
<hr />

<pre>
By clicking on this link, you accept that:

* This button/link will immediately delete your existing stored OTP secret so the codes generated by your authenticator app will not work.
* You must complete the set up on hte next page or you will not be able to sign in again
* Any backup codes you downloaded  will NOT be affected by this change.
</pre>
<div><%= link_to "Reset my MFA ", edit_users_mfa_path %></div>
<hr />

<pre>
By clicking on this link, you accept that:

* This will immediately disable MFA and destroy your OTP secret.
* You will no longer need an OTP code to sign in.
* Your stored OTP secret will be discarded so the OTP codes generated by your authenticator app will never work again.
</pre>
<div><%= link_to "Disable MFA on my account", users_mfa_path, method: :delete %></div>
<hr />

<pre>
By clicking on this link, you accept that:

* This will immediately invalidate any existing backup codes you have.
* You must copy the codes you see on the next screen. They will never be shown to you again (they cannot be because we don't store them unencrypted)
</pre>
<div><%= link_to "Generate new backup codes (discards old codes)", show_backup_codes_users_mfa_path %></div>
<hr />

